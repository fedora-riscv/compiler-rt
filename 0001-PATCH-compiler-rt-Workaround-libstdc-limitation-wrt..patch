From a3ffd6cc6ebe615f6f622bf91f33d089880b6926 Mon Sep 17 00:00:00 2001
From: serge-sans-paille <sguelton@redhat.com>
Date: Thu, 25 Feb 2021 14:12:57 +0100
Subject: [PATCH 1/2] [PATCH][compiler-rt] Workaround libstdc++ limitation wrt.
 thread copy

---
 compiler-rt/lib/fuzzer/FuzzerDriver.cpp | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/compiler-rt/lib/fuzzer/FuzzerDriver.cpp b/compiler-rt/lib/fuzzer/FuzzerDriver.cpp
index 6b007f2ad45c..5600b350c58c 100644
--- a/compiler-rt/lib/fuzzer/FuzzerDriver.cpp
+++ b/compiler-rt/lib/fuzzer/FuzzerDriver.cpp
@@ -294,7 +294,7 @@ static int RunInMultipleProcesses(const std::vector<std::string> &Args,
   std::thread Pulse(PulseThread);
   Pulse.detach();
   for (unsigned i = 0; i < NumWorkers; i++)
-    V.push_back(std::thread(WorkerThread, std::ref(Cmd), &Counter, NumJobs,
+    V.emplace_back(std::thread(WorkerThread, std::ref(Cmd), &Counter, NumJobs,
                             &HasErrors));
   for (auto &T : V)
     T.join();
-- 
2.31.1

